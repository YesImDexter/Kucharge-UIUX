<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receipt - Kucharge</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- HTML2Canvas for image generation -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Configure Tailwind for dark mode -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#3B82F6',
                        'primary-green': '#10B981',
                    }
                }
            }
        }
    </script>

    <!-- Print Styles -->
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }

        @media print {
            .no-print {
                display: none !important;
            }

            .print-container {
                max-width: none !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                page-break-inside: avoid;
                font-size: 11px !important;
            }

            body {
                background: white !important;
                margin: 0 !important;
                padding: 0 !important;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
                font-size: 11px !important;
                line-height: 1.3 !important;
            }

            html {
                margin: 0 !important;
                padding: 0 !important;
            }

            * {
                print-color-adjust: exact !important;
                -webkit-print-color-adjust: exact !important;
            }

            .receipt-content {
                max-width: 180mm !important;
                margin: 0 auto !important;
                padding: 0 !important;
                border-radius: 0 !important;
                border: none !important;
                box-shadow: none !important;
            }

            .receipt-header {
                padding: 10mm 8mm !important;
                margin-bottom: 3mm !important;
            }

            .receipt-body {
                padding: 3mm 8mm 8mm 8mm !important;
            }

            .text-4xl {
                font-size: 20px !important;
                line-height: 1.2 !important;
            }

            .text-3xl {
                font-size: 18px !important;
                line-height: 1.2 !important;
            }

            .text-2xl {
                font-size: 16px !important;
                line-height: 1.2 !important;
            }

            .text-xl {
                font-size: 14px !important;
                line-height: 1.2 !important;
            }

            .text-lg {
                font-size: 12px !important;
                line-height: 1.2 !important;
            }

            .text-sm {
                font-size: 10px !important;
                line-height: 1.2 !important;
            }

            .text-xs {
                font-size: 9px !important;
                line-height: 1.2 !important;
            }

            .space-y-4>*+* {
                margin-top: 6px !important;
            }

            .space-y-3>*+* {
                margin-top: 4px !important;
            }

            .space-y-2>*+* {
                margin-top: 3px !important;
            }

            .mb-6 {
                margin-bottom: 4mm !important;
            }

            .mb-4 {
                margin-bottom: 3mm !important;
            }

            .mb-3 {
                margin-bottom: 2mm !important;
            }

            .mb-2 {
                margin-bottom: 1.5mm !important;
            }

            .p-6 {
                padding: 4mm !important;
            }

            .p-4 {
                padding: 3mm !important;
            }

            .p-3 {
                padding: 2mm !important;
            }

            .grid-cols-2 {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 2mm !important;
            }

            .border-b {
                border-bottom: 1px solid #e5e7eb !important;
            }

            .pb-4 {
                padding-bottom: 3mm !important;
            }

            h1,
            h2,
            h3 {
                margin: 0 !important;
                padding: 0 !important;
            }
        }

        /* Canvas styling for image generation */
        #receipt-canvas {
            position: absolute;
            left: -9999px;
            top: -9999px;
        }
    </style>
</head>

<body class="h-full bg-gray-50 dark:bg-gray-900 transition-colors duration-300">

    <div class="min-h-full flex items-center justify-center px-4 py-6 sm:px-6 lg:px-8">
        <div class="max-w-md w-full print-container">

            <!-- Receipt Card -->
            <div id="receipt-content"
                class="receipt-content bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl overflow-hidden relative">

                <!-- Dark Mode Toggle - Top Right of Container -->
                <!-- <div class="absolute top-4 right-4 z-10 no-print no-capture">
                    <button id="dark-mode-toggle-receipt" onclick="toggleDarkMode()"
                        class="px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 text-xs font-medium flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="text-blue-400">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        Dark
                    </button>
                </div> -->

                <!-- Header -->
                <div class="receipt-header bg-gradient-to-r from-blue-600 to-green-600 px-6 py-8 text-center">
                    <div class="mb-4">
                        <img src="Images/Logo.png" alt="Kucharge" class="h-12 mx-auto brightness-0 invert">
                    </div>
                    <h1 class="text-2xl font-bold text-white mb-2">
                        Charging Receipt
                    </h1>
                    <p class="text-blue-100 text-sm">
                        EV Charging Transaction
                    </p>
                </div>

                <!-- Receipt Content -->
                <div class="receipt-body p-6">

                    <!-- Transaction Status -->
                    <div
                        class="text-center mb-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                        <div class="flex items-center justify-center gap-2 mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" class="text-green-600">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                <polyline points="22,4 12,14.01 9,11.01" />
                            </svg>
                            <span class="text-lg font-bold text-green-600 dark:text-green-400">COMPLETED</span>
                        </div>
                        <p class="text-sm text-green-700 dark:text-green-300">
                            Transaction completed successfully
                        </p>
                    </div>

                    <!-- Transaction Details -->
                    <div class="space-y-4">
                        <div class="border-b border-gray-200 dark:border-gray-700 pb-4">
                            <h3
                                class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="text-blue-600">
                                    <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
                                    <path d="m7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                Transaction Details
                            </h3>

                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Transaction ID:</span>
                                    <p id="receipt-transaction-id"
                                        class="font-mono font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Date & Time:</span>
                                    <p id="receipt-timestamp" class="font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Status:</span>
                                    <p id="receipt-status" class="font-medium text-green-600 dark:text-green-400">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Duration:</span>
                                    <p id="receipt-duration" class="font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                            </div>
                        </div>

                        <div class="border-b border-gray-200 dark:border-gray-700 pb-4">
                            <h3
                                class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="text-green-600">
                                    <path d="M18.37 2.63 14 7l-1.41-1.41L15.22 3A2 2 0 0 1 17 2.22Z" />
                                    <path d="M9 8a5 5 0 0 0 5 5v0a5 5 0 0 0 5-5v0a5 5 0 0 0-5-5v0a5 5 0 0 0-5 5Z" />
                                    <path d="M15 13v1a2 2 0 0 1-2 2v0a2 2 0 0 1-2-2v-1" />
                                    <path d="M9 21h6" />
                                </svg>
                                Charging Information
                            </h3>

                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Charger ID:</span>
                                    <p id="receipt-charger-id"
                                        class="font-mono font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Location:</span>
                                    <p id="receipt-location" class="font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Charger Type:</span>
                                    <p id="receipt-charger-type" class="font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                                <div>
                                    <span class="text-gray-600 dark:text-gray-400">Power Delivered:</span>
                                    <p id="receipt-power" class="font-medium text-gray-900 dark:text-white">-</p>
                                </div>
                            </div>
                        </div>

                        <div class="border-b border-gray-200 dark:border-gray-700 pb-4">
                            <h3
                                class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="text-yellow-600">
                                    <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                                </svg>
                                Payment Summary
                            </h3>

                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400">Charging Amount:</span>
                                    <span id="receipt-amount" class="font-medium text-gray-900 dark:text-white">RM
                                        0.00</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400">Service Fee:</span>
                                    <span class="font-medium text-gray-900 dark:text-white">RM 0.50</span>
                                </div>
                                <div
                                    class="flex justify-between items-center text-lg font-bold pt-2 border-t border-gray-200 dark:border-gray-700">
                                    <span class="text-gray-900 dark:text-white">Total Paid:</span>
                                    <span id="receipt-total" class="text-green-600 dark:text-green-400">RM 0.00</span>
                                </div>
                            </div>
                        </div>

                        <!-- QR Code Section -->
                        <div class="text-center py-4">
                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-3">
                                Scan for digital copy
                            </h4>
                            <div
                                class="w-20 h-20 bg-gray-100 dark:bg-gray-700 rounded-lg mx-auto flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="text-gray-400">
                                    <rect width="5" height="5" x="3" y="3" rx="1" />
                                    <rect width="5" height="5" x="16" y="3" rx="1" />
                                    <rect width="5" height="5" x="3" y="16" rx="1" />
                                    <path d="M21 16h-3a2 2 0 0 0-2 2v3" />
                                    <path d="M21 21v.01" />
                                    <path d="M12 7v3a2 2 0 0 1-2 2H7" />
                                    <path d="M3 12h.01" />
                                    <path d="M12 3h.01" />
                                    <path d="M12 16v.01" />
                                    <path d="M16 12h1" />
                                    <path d="M21 12v.01" />
                                    <path d="M12 21v-1" />
                                </svg>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div class="text-center pt-4 border-t border-gray-200 dark:border-gray-700">
                            <p class="text-xs text-gray-500 dark:text-gray-400 mb-1">
                                Thank you for choosing Kucharge!
                            </p>
                            <p class="text-xs text-gray-400 dark:text-gray-500">
                                Need help? Contact support: support@kucharge.com
                            </p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-2">
                                Â© 2025 Kucharge. All rights reserved.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons (Mobile) -->
            <div class="mt-6 space-y-3 no-print">
                <button onclick="downloadReceipt()"
                    class="w-full py-3 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="7,10 12,15 17,10" />
                        <line x1="12" y1="15" x2="12" y2="3" />
                    </svg>
                    Download Receipt
                </button>

                <button onclick="shareReceipt()"
                    class="w-full py-3 px-4 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8" />
                        <polyline points="16,6 12,2 8,6" />
                        <line x1="12" y1="2" x2="12" y2="15" />
                    </svg>
                    Share Receipt
                </button>

                <button onclick="printReceipt()"
                    class="w-full py-3 px-4 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6,9 6,2 18,2 18,9" />
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
                        <rect width="12" height="8" x="6" y="14" />
                    </svg>
                    Print Receipt
                </button>

                <button onclick="goBackToCharging()"
                    class="w-full py-3 px-4 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 12H6m6-7-7 7 7 7" />
                    </svg>
                    Back to Charging
                </button>
            </div>
        </div>
    </div>

    <!-- Hidden canvas for image generation -->
    <canvas id="receipt-canvas" style="display: none;"></canvas>

    <!-- JavaScript -->
    <script src="script.js"></script>
    <script>
        // Initialize receipt page
        function initializeReceiptPage() {
            // Load receipt data from localStorage
            const receiptDataString = localStorage.getItem('receiptData');

            if (receiptDataString) {
                const receiptData = JSON.parse(receiptDataString);
                populateReceiptData(receiptData);
            } else {
                // Fallback data if no localStorage data found
                const fallbackData = {
                    chargerId: 'KUC001',
                    amount: '25.00',
                    duration: 0.25,
                    status: 'Completed',
                    timestamp: new Date().toLocaleString(),
                    transactionId: 'TXN' + Date.now(),
                    location: 'Sheraton Hotel',
                    chargerType: 'AC Type 2',
                    powerDelivered: '22kW'
                };
                populateReceiptData(fallbackData);
            }
        }

        // Populate receipt with data
        function populateReceiptData(data) {
            document.getElementById('receipt-transaction-id').textContent = data.transactionId;
            document.getElementById('receipt-timestamp').textContent = data.timestamp;
            document.getElementById('receipt-status').textContent = data.status;
            document.getElementById('receipt-duration').textContent = `${Math.round(data.duration * 60)} seconds`;
            document.getElementById('receipt-charger-id').textContent = data.chargerId;
            document.getElementById('receipt-location').textContent = data.location;
            document.getElementById('receipt-charger-type').textContent = data.chargerType;
            document.getElementById('receipt-power').textContent = data.powerDelivered;
            document.getElementById('receipt-amount').textContent = `RM ${data.amount}`;

            // Calculate total (amount + service fee)
            const total = (parseFloat(data.amount) + 0.50).toFixed(2);
            document.getElementById('receipt-total').textContent = `RM ${total}`;
        }

        // Download receipt as image
        function downloadReceipt() {
            const receiptElement = document.getElementById('receipt-content');
            const transactionId = document.getElementById('receipt-transaction-id').textContent;

            // Configure html2canvas options for high quality image
            const options = {
                allowTaint: true,
                useCORS: true,
                scale: 2, // Higher resolution
                backgroundColor: '#ffffff',
                width: receiptElement.scrollWidth,
                height: receiptElement.scrollHeight,
                scrollX: 0,
                scrollY: 0,
                removeContainer: true,
                logging: false,
                ignoreElements: function (element) {
                    // Exclude elements with no-capture class (like dark mode toggle)
                    return element.classList && element.classList.contains('no-capture');
                }
            };

            // Temporarily force light mode and remove rounded corners for consistent image output
            const body = document.body;
            const wasInDarkMode = body.classList.contains('dark');
            body.classList.remove('dark');

            // Temporarily remove rounded corners for image generation
            receiptElement.classList.remove('rounded-2xl');
            receiptElement.style.borderRadius = '0';

            html2canvas(receiptElement, options).then(canvas => {
                // Restore dark mode and rounded corners
                if (wasInDarkMode) {
                    body.classList.add('dark');
                }
                receiptElement.classList.add('rounded-2xl');
                receiptElement.style.borderRadius = '';

                // Convert canvas to blob
                canvas.toBlob(function (blob) {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Kucharge-Receipt-${transactionId}.jpg`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 'image/jpeg', 0.95); // High quality JPEG
            }).catch(error => {
                console.error('Error generating receipt image:', error);
                // Restore styles even if error occurs
                if (wasInDarkMode) {
                    body.classList.add('dark');
                }
                receiptElement.classList.add('rounded-2xl');
                receiptElement.style.borderRadius = '';
                // Fallback to HTML download if image generation fails
                downloadReceiptHTML();
            });
        }

        // Share receipt function
        function shareReceipt() {
            const receiptElement = document.getElementById('receipt-content');
            const transactionId = document.getElementById('receipt-transaction-id').textContent;

            // Configure html2canvas options for sharing
            const options = {
                allowTaint: true,
                useCORS: true,
                scale: 2,
                backgroundColor: '#ffffff',
                width: receiptElement.scrollWidth,
                height: receiptElement.scrollHeight,
                scrollX: 0,
                scrollY: 0,
                removeContainer: true,
                logging: false,
                ignoreElements: function (element) {
                    // Exclude elements with no-capture class (like dark mode toggle)
                    return element.classList && element.classList.contains('no-capture');
                }
            };

            // Temporarily force light mode and remove rounded corners for consistent image output
            const body = document.body;
            const wasInDarkMode = body.classList.contains('dark');
            body.classList.remove('dark');

            // Temporarily remove rounded corners for image generation
            receiptElement.classList.remove('rounded-2xl');
            receiptElement.style.borderRadius = '0';

            html2canvas(receiptElement, options).then(canvas => {
                // Restore dark mode and rounded corners
                if (wasInDarkMode) {
                    body.classList.add('dark');
                }
                receiptElement.classList.add('rounded-2xl');
                receiptElement.style.borderRadius = '';

                canvas.toBlob(function (blob) {
                    const file = new File([blob], `Kucharge-Receipt-${transactionId}.jpg`, { type: 'image/jpeg' });

                    // Check if Web Share API is supported
                    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                        navigator.share({
                            title: 'Kucharge Receipt',
                            text: `EV Charging Receipt - Transaction ${transactionId}`,
                            files: [file]
                        }).then(() => {
                            console.log('Receipt shared successfully');
                        }).catch(error => {
                            console.error('Error sharing receipt:', error);
                            fallbackShare(blob, transactionId);
                        });
                    } else {
                        // Fallback for browsers that don't support Web Share API
                        fallbackShare(blob, transactionId);
                    }
                }, 'image/jpeg', 0.95);
            }).catch(error => {
                console.error('Error generating receipt image for sharing:', error);
                // Restore styles even if error occurs
                if (wasInDarkMode) {
                    body.classList.add('dark');
                }
                receiptElement.classList.add('rounded-2xl');
                receiptElement.style.borderRadius = '';
                alert('Unable to generate receipt image for sharing. Please try downloading instead.');
            });
        }

        // Fallback share function for browsers without Web Share API
        function fallbackShare(blob, transactionId) {
            // Create a temporary URL for the image
            const url = URL.createObjectURL(blob);

            // Try to copy the image to clipboard (modern browsers)
            if (navigator.clipboard && window.ClipboardItem) {
                const item = new ClipboardItem({ 'image/jpeg': blob });
                navigator.clipboard.write([item]).then(() => {
                    alert('Receipt image copied to clipboard! You can now paste it in any app.');
                    URL.revokeObjectURL(url);
                }).catch(() => {
                    // If clipboard fails, provide download option
                    if (confirm('Sharing not supported on this device. Would you like to download the receipt instead?')) {
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `Kucharge-Receipt-${transactionId}.jpg`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    }
                    URL.revokeObjectURL(url);
                });
            } else {
                // Final fallback - just download
                if (confirm('Sharing not supported on this device. Would you like to download the receipt instead?')) {
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Kucharge-Receipt-${transactionId}.jpg`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                }
                URL.revokeObjectURL(url);
            }
        }

        // Fallback HTML download function
        function downloadReceiptHTML() {
            const receiptContent = document.documentElement.outerHTML;
            const blob = new Blob([receiptContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kucharge-receipt-${document.getElementById('receipt-transaction-id').textContent}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Print receipt
        function printReceipt() {
            window.print();
        }

        // Go back to charging session
        function goBackToCharging() {
            window.close();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeReceiptPage);
    </script>
</body>

</html>